§u§
How can I make a minecraft mod that changes the behavior of another mod? (fabric)
§a§
Making a mod that changes the behavior of another mod is a very common and powerful technique in the modding world. These are often called "compatibility mods," "add-ons," or "tweaks." With Fabric, the primary tool for this is **Mixins**.

Let's break down how to do this, from the safest and easiest methods to the most powerful (and fragile).

### The Core Concept: Mixins

A Mixin is a special class that "mixes in" to an existing Minecraft or mod class at runtime. It allows you to:
*   **Inject** your own code before, after, or at the start of a method.
*   **Redirect** a method call to your own function.
*   **Overwrite** an entire method (use this as a last resort!).
*   **Modify** local variables within a method.

This is how you'll surgically alter the other mod's code without ever touching its source files.

---

### Step 1: Set Up Your Modding Environment

If you haven't already, set up a basic Fabric mod project. The [Fabric Wiki Tutorial](https://fabricmc.net/wiki/tutorial:setup) is the best place to start.

### Step 2: Add the Other Mod as a Dependency

To make your IDE (like IntelliJ IDEA or VSCode) aware of the classes from the other mod, you need to tell your project that it depends on it.

Open your `build.gradle` file and add the other mod to the `modImplementation` block inside `dependencies`.

```groovy
// build.gradle

dependencies {
    // ... other dependencies
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"

    // Add this line!
    // Replace 'othermodid' with the actual Mod ID of the mod you want to change.
    // You can find this in their fabric.mod.json or on CurseForge/Modrinth.
    modImplementation "curse.maven:other-mod-name-123456" // Example for CurseForge
    // OR
    modImplementation "net.example:othermod:1.0.0" // Example for Maven
}
```
> **How to find the dependency string?** The easiest way is to go to the mod's CurseForge/Modrinth page, find the version you're targeting, and look for the "Maven" or "Gradle" dependency string. Tools like the [Modrinth API](https://docs.modrinth.com/api/v2/#get-version) can also help.

After adding this, refresh your Gradle project. Your IDE should now be able to see the other mod's code!

### Step 3: Find the Code You Want to Change

This is the detective work. You need to find the specific class and method that controls the behavior you want to change.

1.  **Decompile the Mod:** The easiest way is to use your IDE's built-in decompiler. In IntelliJ, you can just `Ctrl+N` (or `Cmd+N`) and type the name of a class you *think* is related (e.g., `SuperSwordItem` from `com.othermod.items`).
2.  **Use a Java Decompiler:** Tools like [JD-GUI](http://java-decompiler.github.io/), [Fernflower](https://github.com/JetBrains/intellij-community/tree/master/plugins/java-decompiler/engine), or [Vineflower](https://github.com/Vineflower/Vineflower) can open the mod's `.jar` file (found in your `.minecraft/mods` folder) and show you the source code.

Let's say you find this in `com.othermod.items.SuperSwordItem.java`:
```java
// This is the code FROM THE OTHER MOD
public class SuperSwordItem extends SwordItem {
    // ... constructor ...

    @Override
    public float getAttackDamage() {
        return 20.0f; // You want to change this!
    }
}
```

### Step 4: Choose Your Weapon (The Mixin Type)

Here are the most common techniques, from best to worst.

#### Method A: `@ModifyVariable` (The Surgical Strike)

This is perfect for changing a single value, like the `20.0f` in our example. It's clean and less likely to break.

1.  Create a new package in your project, e.g., `com.yourmod.mixin`.
2.  Create a new Java class, e.g., `SuperSwordItemMixin.java`.

```java
// src/main/java/com/yourmod/mixin/SuperSwordItemMixin.java

package com.yourmod.mixin;

import com.othermod.items.SuperSwordItem;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.ModifyVariable;

@Mixin(SuperSwordItem.class) // The class we are targeting
public abstract class SuperSwordItemMixin {

    // This method targets the getAttackDamage() method in SuperSwordItem
    @ModifyVariable(
        method = "getAttackDamage", // The name of the method to target
        at = @At("RETURN"),         // We want to change the value right before it returns
        ordinal = 0,                // In case there are multiple float variables, 0 is the first
        name = "f"                  // The name of the return variable in bytecode (use a decompiler to find this, or just guess 'f', 'd', 'i')
    )
    private float modifyAttackDamage(float originalValue) {
        // Let's double the damage!
        return originalValue * 2.0f;
    }
}
```

#### Method B: `@Inject` (Adding Behavior)

Use this if you want to run code *before* or *after* the original method runs. For example, adding a particle effect when the sword is swung.

```java
@Mixin(SuperSwordItem.class)
public class SuperSwordItemMixin {

    @Inject(
        method = "onStoppedUsing(Lnet/minecraft/item/ItemStack;Lnet/minecraft/world/World;Lnet/minecraft/entity/LivingEntity;I)V", // The full method signature
        at = @At("HEAD") // HEAD = beginning, TAIL = end
    )
    private void onSwing(ItemStack stack, World world, LivingEntity user, int remainingUseTicks, CallbackInfo ci) {
        // Your code here!
        System.out.println("Super Sword was swung!");
    }
}
```
> **Tip:** To get the full method signature, use your IDE's "Copy Reference" feature or a tool like [ASM Bytecode Viewer](https://plugins.jetbrains.com/plugin/10111-asm-bytecode-viewer).

#### Method C: `@Redirect` (Changing a Dependency)

This is extremely powerful. Use it to change a method call *inside* another method. Imagine `getAttackDamage()` looked like this:

```java
// Code from the other mod
public float getAttackDamage() {
    return 5.0f + getBaseDamage(); // You want to change getBaseDamage()
}
```

You can't use `@ModifyVariable` here. You need to intercept the call to `getBaseDamage()`.

```java
@Mixin(SuperSwordItem.class)
public class SuperSwordItemMixin {

    @Redirect(
        method = "getAttackDamage",
        at = @At(
            value = "INVOKE",
            target = "Lcom/othermod/items/SuperSwordItem;getBaseDamage()F" // The method call to redirect
        )
    )
    private float redirectBaseDamage(SuperSwordItem instance) {
        // Instead of calling the original, return our own value!
        return 100.0f;
    }
}
```

#### Method D: `@Overwrite` (The Nuke - AVOID IF POSSIBLE)

This completely replaces the original method. It's very brittle—if the other mod updates its method, your overwrite might fail or cause a crash. Only use this if nothing else works.

```java
@Mixin(SuperSwordItem.class)
public class SuperSwordItemMixin {

    @Overwrite
    public float getAttackDamage() {
        // Your completely new implementation.
        return 999.0f;
    }
}
```

### Step 5: Register Your Mixin

Fabric needs to know your mixin class exists. Create a file in `src/main/resources`: `yourmodid.mixins.json`.

```json
{
  "required": true,
  "package": "com.yourmod.mixin",
  "compatibilityLevel": "JAVA_17",
  "mixins": [
    "SuperSwordItemMixin"
  ],
  "injectors": {
    "defaultRequire": 1
  }
}
```

Finally, tell Fabric to load this file in your `fabric.mod.json`:

```json
{
  "schemaVersion": 1,
  "id": "yourmodid",
  // ... other stuff ...
  "mixins": [
    "yourmodid.mixins.json"
  ]
}
```

### Important Considerations & Best Practices

*   **Fragility:** Your mod **will** break when the other mod updates. This is the #1 downside. Be prepared to update your mod.
*   **Access Widener:** What if the value you want to change is `private`? You'll need an Access Widener. This is a file that tells Mixin it's okay to access private members.
    1.  Add `accessWidener = "yourmodid.accesswidener"` to your `fabric.mod.json` `mixins` section.
    2.  Create the file `yourmodid.accesswidener` in `src/main/resources`.
    3.  Add a line like: `accessible field com.othermod.items.SuperSwordItem attackDamage F`. (You can get this line automatically by running the game once; it will print the required line to the console).
*   **Configuration:** Don't hard-code your changes! Use a config library like [Cloth Config](https://www.curseforge.com/minecraft/mc-mods/cloth-config) to let users enable/disable your changes or tweak values (e.g., a damage multiplier).
*   **Be a Good Citizen:** Check the other mod's license. Most permissive licenses (MIT, Apache 2.0) are fine with this. Pin your dependency to the specific version of the mod you tested with to avoid unexpected breakages.

You now have all the tools to tweak, fix, and build upon other people's mods. Happy coding
